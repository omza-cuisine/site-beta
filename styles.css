document.addEventListener('DOMContentLoaded', function() {
    // Header scroll effect
    window.addEventListener('scroll', function() {
        const header = document.querySelector('header');
        if (window.scrollY > 50) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
    });

    // Dropdown menu functionality
    const dropdowns = document.querySelectorAll('.dropdown');
    
    function setupDropdowns() {
        const isMobile = window.innerWidth <= 768;
        
        dropdowns.forEach(dropdown => {
            const link = dropdown.querySelector('a');
            const menu = dropdown.querySelector('.dropdown-menu');
            
            // Remove all existing event listeners to avoid duplicates
            link.removeEventListener('click', handleClick);
            dropdown.removeEventListener('mouseenter', showMenu);
            dropdown.removeEventListener('mouseleave', hideMenu);
            
            if (isMobile) {
                // Mobile behavior - toggle on click
                link.addEventListener('click', handleClick);
            } else {
                // Desktop behavior - show/hover on hover
                dropdown.addEventListener('mouseenter', showMenu);
                dropdown.addEventListener('mouseleave', hideMenu);
            }
        });
        
        function handleClick(e) {
            if (this.parentElement.classList.contains('dropdown')) {
                e.preventDefault();
                const dropdown = this.parentElement;
                const menu = dropdown.querySelector('.dropdown-menu');
                
                // Close all other dropdowns
                dropdowns.forEach(otherDropdown => {
                    if (otherDropdown !== dropdown) {
                        otherDropdown.classList.remove('active');
                        const otherMenu = otherDropdown.querySelector('.dropdown-menu');
                        if (otherMenu) otherMenu.style.display = 'none';
                    }
                });
                
                // Toggle current dropdown
                if (menu.style.display === 'block') {
                    menu.style.display = 'none';
                    dropdown.classList.remove('active');
                } else {
                    menu.style.display = 'block';
                    dropdown.classList.add('active');
                }
            }
        }
        
        function showMenu() {
            const menu = this.querySelector('.dropdown-menu');
            if (menu) {
                menu.style.opacity = '1';
                menu.style.visibility = 'visible';
            }
        }
        
        function hideMenu() {
            const menu = this.querySelector('.dropdown-menu');
            if (menu) {
                menu.style.opacity = '0';
                menu.style.visibility = 'hidden';
            }
        }
    }

    // Initial setup
    setupDropdowns();
    
    // Re-setup when window is resized
    window.addEventListener('resize', function() {
        setupDropdowns();
    });
});
